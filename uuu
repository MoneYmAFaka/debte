-- Load Arrayfield UI library with error handling
local Arrayfield
local success, result = pcall(function()
    return loadstring(game:HttpGet("https://raw.githubusercontent.com/UI-Interface/CustomFIeld/main/RayField.lua"))()
end)

if not success then
    warn("Failed to load Arrayfield UI library: " .. tostring(result))
    return
end
Arrayfield = result

-- Initialize services
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local UserInputService = game:GetService("UserInputService")

-- Auto Tap Loop
local autoTapLoopEnabled = false
local autoTapDelay = 0.2

local function autoTapLoop()
    task.spawn(function()
        while autoTapLoopEnabled do
            pcall(function()
                local args = {}
                ReplicatedStorage:WaitForChild("Remotes", 9e9)
                    :WaitForChild("Click", 9e9)
                    :FireServer(unpack(args))
            end)
            task.wait(autoTapDelay)
        end
    end)
end

-- Auto Upgrade Loop
local autoUpgradeEnabled = false
local upgradeArgsList = {
    { "DNA", "DNA", 1 },
    { "DNA", "BaseDNA", 1 },
    { "DNA", "AutoClicker", 1 },
}

local function autoUpgradeLoop()
    task.spawn(function()
        while autoUpgradeEnabled do
            pcall(function()
                for _, args in ipairs(upgradeArgsList) do
                    ReplicatedStorage:WaitForChild("Remotes", 9e9)
                        :WaitForChild("Upgrades", 9e9)
                        :WaitForChild("Upgrade", 9e9)
                        :FireServer(unpack(args))
                    task.wait(0.1) -- prevent spamming too hard
                end
            end)
            task.wait(1) -- upgrade cycle delay
        end
    end)
end

-- Create UI
local Window = Arrayfield:CreateWindow({
    Name = "Auto Features Hub",
    LoadingTitle = "Loading Interface",
    LoadingSubtitle = "by xAI",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "AutoHub",
        FileName = "Config"
    }
})

local MainTab = Window:CreateTab("Main", 4483362458)

-- Auto Tap Loop Toggle
MainTab:CreateToggle({
    Name = "Auto Tap Loop (0.2s)",
    Info = "Automatically taps every 0.2s",
    CurrentValue = false,
    Flag = "AutoTapLoop",
    Callback = function(Value)
        autoTapLoopEnabled = Value
        if Value then autoTapLoop() end
    end,
})

-- Auto Upgrade Toggle
MainTab:CreateToggle({
    Name = "Auto Upgrade",
    Info = "Cycles DNA, BaseDNA, AutoClicker upgrades",
    CurrentValue = false,
    Flag = "AutoUpgrade",
    Callback = function(Value)
        autoUpgradeEnabled = Value
        if Value then autoUpgradeLoop() end
    end,
})

-- UI Close Hotkey (default: E)
local closeKey = Enum.KeyCode.E
UserInputService.InputBegan:Connect(function(input)
    if input.KeyCode == closeKey then
        Window:Destroy()
    end
end)
